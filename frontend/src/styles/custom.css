/* ===== 基礎高度 ===== */
html, body, #wrapper, #content-wrapper { height: 100%; }

/* ===== Footer ===== */
.footer{ display:flex; width:100%; height:32px; position:relative; z-index:10; font-size:14px; }
.footer-main{ flex:1; background:#f8f9fc; color:#6c757d; display:flex; align-items:center; justify-content:center; }

/* ===== Tokens ===== */
:root{
  --page-bg:#f5f5f7;
  --text:#1d1d1f;
  --card:#fff;
  --border:rgba(0,0,0,.12);
  --shadow:0 6px 24px rgba(0,0,0,.06);
  --btn:#111;
}
body{
  background:var(--page-bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans","Helvetica Neue",Arial,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji",sans-serif;
}

/* ===== Apple 風 Topbar ===== */
.topbar-apple{ position:sticky; top:0; z-index:1040; border-bottom:1px solid rgba(0,0,0,.06); background:var(--card); }
.topbar-apple .navbar-brand{ color:#111!important; font-weight:800; }
.topbar-apple .nav-link{
  background:var(--card)!important; color:var(--text)!important;
  border-radius:12px; padding:.55rem 1rem; margin:.25rem .35rem; font-weight:800; display:inline-flex; align-items:center;
}
.topbar-apple .dropdown-toggle::after{ display:none!important; }
#alertsDropdown i{ color:#111!important; }

/* 桌機下拉：由按鈕延伸 + 動畫 */
.topbar-apple .dropdown{ position:relative; }
.topbar-apple .dropdown-menu{
  display:block; position:absolute; top:100%; left:0; min-width:220px;
  background:var(--card); color:var(--text);
  border:1px solid var(--border); border-top:0; border-radius:0 12px 12px 12px;
  box-shadow:var(--shadow);
  opacity:0; transform:translateY(-4px) scaleY(.96); visibility:hidden; pointer-events:none;
  transition:transform .2s, opacity .2s;
}
.topbar-apple .dropdown.show .dropdown-menu{ opacity:1; transform:none; visibility:visible; pointer-events:auto; }
.topbar-apple .nav-item.show>.nav-link{ border:1px solid var(--border); border-bottom-color:transparent; border-radius:12px 12px 0 0; }
.topbar-apple .dropdown-item{ color:var(--text)!important; border-radius:8px; padding:.5rem .8rem; }
.topbar-apple .dropdown-item:hover{ background:#f5f5f7; }

/* 搜尋（桌機） */
/* 搜尋（桌機） */
.topbar-apple .navbar-search{ display:inline-flex; align-items:center; }
.topbar-apple .navbar-search .btn{
  background:var(--card)!important; color:var(--text)!important; border:0;
  width:34px; height:34px; border-radius:999px; display:inline-flex; justify-content:center; align-items:center;
}
.topbar-apple .navbar-search input{
  width:0; opacity:0; pointer-events:none; border:0; height:34px; margin-left:.5rem;
  border-radius:999px; padding:0 .75rem; background:var(--card)!important; color:var(--text)!important;
  transition:width .22s, opacity .18s;
}
.topbar-apple .navbar-search.is-open input{ width:240px; opacity:1; pointer-events:auto; }
/* 你後來加的：打開時縮短為 50px */
.topbar-apple .navbar-search.is-open input{ width:50px; }

/* ===== 卡片 / 表單 / 按鈕 ===== */
.page-body{ max-width:1120px; }
.apple-card{ background:var(--card); border:1px solid var(--border); border-radius:16px; padding:24px; box-shadow:var(--shadow); }
.page-title{ font-weight:700; letter-spacing:-.2px; }
.form-label{ font-weight:600; }
.form-select, .form-control{ height:42px; border-radius:12px; border:1px solid var(--border); }
.btn-primary, .apple-btn{ background:var(--btn)!important; border-color:var(--btn)!important; color:#fff!important; border-radius:12px; }

/* ===== Choices（簡化） ===== */
.choices__inner{ min-height:44px; border-radius:12px; border:1px solid var(--border); padding:10px 16px; }
.choices__list--dropdown{ border-radius:12px; border:1px solid var(--border); box-shadow:var(--shadow); }

/* ===== 通知面板（桌機：靠右彈出） ===== */
#alertsDropdown + .dropdown-menu{ right:12px!important; left:auto!important; min-width:22rem; }
.notif-head{display:flex;justify-content:space-between;align-items:center;padding:.5rem .75rem;border-bottom:1px solid rgba(0,0,0,.06)}
.notif-clear{background:#fff;border:1px solid rgba(0,0,0,.12);border-radius:10px;padding:.25rem .5rem;font-size:.85rem;cursor:pointer}
.notif-list{list-style:none;margin:0;padding:.25rem}
.notif-item{display:flex;gap:.5rem;align-items:flex-start;padding:.5rem;border-radius:12px}
.notif-item:hover{background:#f5f5f7}
.notif-dot{width:8px;height:8px;border-radius:999px;background:#111;margin-top:.5rem}
.notif-main{flex:1;min-width:0}
.notif-time{font-size:.8rem;color:#6e6e73}
.notif-text{font-weight:600;color:#1d1d1f;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.notif-close{border:0;background:transparent;font-size:18px;line-height:1;color:#6e6e73;padding:0 .25rem;cursor:pointer}
.notif-empty{padding:1rem;color:#6e6e73;text-align:center}

/* 其它小樣式 */
.topbar-clock{ font-variant-numeric: tabular-nums; font-weight:600; opacity:.85; }
.section-title { margin: 8px 0 6px; line-height: 1.2; }
.chart-box, .chart-box--sm { margin-top: 10px; }
.apple-card .row.g-3 { margin-bottom: 10px; }

/* ======= 手機版（合併同區塊） ======= */
@media (max-width:1120px){
  /* A) 折疊區塊是一塊 panel */
  .topbar-apple .navbar-collapse.show{
    display:block !important;
    background:var(--card);
    border:1px solid var(--border);
    border-radius:14px;
    box-shadow:var(--shadow);
    padding:0;
    overflow:hidden;
    max-height:80vh;
    opacity:1;
    transform:translateY(0);
  }

  .topbar-apple .navbar{ position:relative; }

  .topbar-apple .navbar-collapse{
    position:absolute; top:100%; left:0; right:0; z-index:1050;
    background:var(--card);
    border:1px solid var(--border);
    border-radius:14px;
    box-shadow:var(--shadow);
    overflow:hidden;
    max-height:0;
    opacity:0;
    transition:max-height .1s ease, opacity .075s ease, transform .1s ease;
    transform:translateY(-6px);
  }

  /* 內距給在內容本身 */
  .topbar-apple .navbar-collapse .navbar-nav{ padding:10px 12px; }

  /* 保證 brand / toggler 不受影響 */
  .topbar-apple .navbar-brand,
  .topbar-apple .navbar-toggler{
    position:relative; z-index:1051; transform:none !important;
  }

  /* B) 手機隱藏搜尋 */
  .topbar-apple .navbar-search, .topbar-apple .fa-search{ display:none !important; }

  /* C) 左側主選單（母→子）同寬往下展開 */
  .topbar-apple .navbar-nav.mr-auto{ width:100%; }
  .topbar-apple .navbar-nav.mr-auto > .nav-item > .nav-link{
    display:block; width:100%;
    padding:.85rem 1rem; margin:0; background:transparent !important; border-radius:0 !important; border:0 !important;
  }
  .topbar-apple .navbar-nav.mr-auto .dropdown-menu{ display:none; }
  .topbar-apple .navbar-nav.mr-auto .dropdown.show .dropdown-menu{
    display:block; position:static !important; width:100%; min-width:0; margin:0 !important; padding:.25rem 0;
    border:0 !important; border-radius:0; box-shadow:none;
  }
  .topbar-apple .navbar-nav.mr-auto .dropdown-item{ padding:.7rem 1.25rem; }

  /* D) 右側「深色/通知/使用者」：第1列三欄；下拉第2列吃滿 */
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto){
    display:grid !important; grid-template-columns:repeat(3,1fr);
    align-items:center; justify-items:center;
    gap:0; padding:.6rem 0; width:100%;
    border-top:0 !important;
  }
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) > ul.navbar-nav{ display:contents; }
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) .nav-item{
    display:flex; justify-content:center; align-items:center; width:100%;
  }
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) .nav-link{
    padding:.25rem; margin:0; width:auto; background:transparent !important;
    height:36px; line-height:1; display:flex; align-items:center; justify-content:center;
  }
  .img-profile{ width:28px; height:28px; position:relative; top:1px; }
  #alertsDropdown i{ position:relative; top:2px; }

  /* 兩個 dropdown 的圖示固定在第 1 列第 2、3 欄 */
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) li.dropdown{ display:contents; }
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) > ul.navbar-nav > li.nav-item:first-child{ grid-column:1; grid-row:1; }
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) > ul.navbar-nav > li.dropdown:nth-of-type(2) > a.nav-link{ grid-column:2; grid-row:1; }
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) > ul.navbar-nav > li.dropdown:nth-of-type(3) > a.nav-link{ grid-column:3; grid-row:1; }

  /* 關閉桌機的靠右浮出；下拉第 2 列全寬 */
  #alertsDropdown + .dropdown-menu,
  #userDropdown   + .dropdown-menu{
    right:auto !important; left:auto !important; top:auto !important; min-width:0 !important; transform:none !important;
  }
  .dropdown-menu-right{ right:auto !important; left:auto !important; }
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) .dropdown-menu{
    position:static !important; grid-column:1 / -1; grid-row:2;
    width:100%; margin:0 !important; padding:.25rem 0 !important;
    border:0 !important; border-radius:0 !important; box-shadow:none !important;
    background:var(--card) !important; opacity:1 !important; visibility:visible !important; pointer-events:auto !important; display:none;
  }
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto) .dropdown.show > .dropdown-menu{ display:block !important; }
}

/* ===== 漢堡（亮/暗都清楚） ===== */
.topbar-apple .navbar-toggler{
  border:1px solid var(--border); border-radius:10px; padding:.25rem .5rem; color:var(--text);
}
.topbar-apple .navbar-toggler-icon{
  width:1.5em; height:1.5em; background-size:100% 100%;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Cpath stroke='currentColor' stroke-width='2' stroke-linecap='round' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E");
}

/* ===== Light theme: 母選單 hover（桌機） ===== */
.topbar-apple .navbar-nav.mr-auto > .nav-item > .nav-link{
  transition: background-color .15s ease, box-shadow .15s ease;
}
.topbar-apple .navbar-nav.mr-auto > .nav-item > .nav-link:hover,
.topbar-apple .navbar-nav.mr-auto > .nav-item.show > .nav-link,
.topbar-apple .navbar-nav.mr-auto > .nav-item > .nav-link:focus-visible{
  background:#f5f5f7; box-shadow: inset 0 0 0 1px var(--border); border-radius:12px;
}

/* ===== 表格容器 ===== */
.apple-card .card-table-wrap{
  width:100%; min-width:0; overflow:auto; border-radius:12px; background:transparent;
}
.apple-card .card-table-wrap > div{ width:100%; min-width:0; }
.apple-card .tabulator{ border:0; background:transparent; }

/* 手機：一個按鈕一列、全寬 */
@media (max-width:576px){
  .actions{ display:grid !important; grid-template-columns:1fr; gap:8px; }
  .actions .btn{ width:100%; display:flex; justify-content:center; }
}

/* ===== 小卡網格 ===== */
.mini-ticker-grid{
  display:grid; grid-template-columns:repeat(5, minmax(160px, 1fr)); gap:12px;
}
@media (max-width:1200px){ .mini-ticker-grid{ grid-template-columns:repeat(3, 1fr); } }
@media (max-width:768px){  .mini-ticker-grid{ grid-template-columns:repeat(2, 1fr); } }
@media (max-width:480px){  .mini-ticker-grid{ grid-template-columns:1fr; } }

.ticker-card{
  border-radius:14px; padding:12px 14px; background:var(--card-bg, #f3f4f6);
  display:flex; flex-direction:column; gap:6px;
}
.ticker-head{ display:flex; justify-content:space-between; align-items:center; font-weight:600; }
.ticker-symbol{ font-size:1.1rem; letter-spacing:.5px; }
.ticker-price{ font-size:1.4rem; font-weight:700; }
.ticker-change{ font-size:.95rem; font-weight:600; }

/* 單一版的漲跌色（保留一次即可） */
.t-up{ color:#0a7a36; }
.t-down{ color:#b00020; }
.t-flat{ color:#6c757d; }

.ticker-foot{ display:flex; justify-content:space-between; align-items:center; margin-top:6px; }
.ticker-badge{ font-size:.75rem; padding:2px 8px; border-radius:999px; background:#f1f3f5; color:#555; }
.ticker-refresh{ font-size:.8rem; opacity:.7; }

/* 搜尋區：保留你設定的寬度（不改功能） */
.topbar-apple .navbar-search.is-open input{ width:50px; }
.topbar .navbar-search{ width:135px; }

/* ===== 桌機：三段式與「跑馬燈靠右」 ===== */
@media (min-width:1330px){
  .topbar-apple .navbar-collapse{
    display:flex; align-items:center; gap:8px;
  }
  /* 左：原本的 mr-auto，但在桌機不再推擠中段 */
  .topbar-apple .navbar-collapse > ul.navbar-nav.mr-auto{
    margin-right:0 !important; flex:0 0 auto;
  }
  /* 中：跑馬燈佔中段，內容靠右 */
  .topbar-apple .navbar-collapse > #topnav-marquee{
    display:flex; justify-content:flex-end; align-items:center;
    flex:1 1 auto; min-width:0;
  }
  /* 讓軌道真的貼右邊 */
  #topnav-marquee .vt-wrap{
    display:flex; justify-content:flex-end; width:100%;
    height:var(--vt-h); line-height:var(--vt-h); overflow:hidden;
  }
  /* 右：時鐘/通知/使用者群 */
  .topbar-apple .navbar-collapse > li.nav-item,
  .topbar-apple .navbar-collapse > ul.navbar-nav:not(.mr-auto){
    list-style:none; margin:0; padding:0; flex:0 0 auto;
  }
}

/* ===== 垂直跑馬燈（固定一行高；避免遮擋） ===== */
#topnav-marquee{
  display:none; pointer-events:none; color:var(--text,#111); font-weight:600;
  --vt-h:24px; /* 與 JS ITEM_H 對齊 */
}
@media (min-width:1330px){ #topnav-marquee{ display:block; } }
#topnav-marquee .vt-track{ display:flex; flex-direction:column; will-change:transform; }
#topnav-marquee .vt-item{ height:var(--vt-h); display:flex; align-items:center; gap:8px; white-space:nowrap; }
#topnav-marquee .price, #topnav-marquee .chg{ font-variant-numeric:tabular-nums; }

/* 下拉永遠蓋過跑馬燈（保留一次） */
.topbar-apple .dropdown-menu{ z-index:1050; }
